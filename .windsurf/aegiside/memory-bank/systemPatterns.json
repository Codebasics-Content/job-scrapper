{
  "schema_version": "1.0.0",
  "last_updated": "2025-10-12T15:40:00+05:30",
  "architecture_patterns": {
    "two_table_optimization": {
      "approach": "Separate URL collection from detail scraping for 80-90% speedup",
      "rationale": "URL scraping is 10-100x faster than full detail scraping. Storing URLs first enables resume capability and deduplication.",
      "implementation": {
        "naukri": {
          "url_scraper": "src/scraper/unified/naukri/url_scraper.py (79 lines)",
          "detail_scraper": "src/scraper/unified/naukri/detail_scraper.py (80 lines)",
          "wrapper": "src/scraper/unified/naukri_unified.py (11 lines)"
        }
      },
      "components": [
        "JobUrlModel (lightweight URL storage)",
        "JobDetailModel (full job details)",
        "job_urls table (fast collection)",
        "jobs table (detail enrichment)",
        "LEFT JOIN query (identify unscraped URLs)"
      ]
    },
    "scraping_architecture": {
      "approach": "Playwright renders list → Extract URLs → Navigate INSIDE each job → Parse full description",
      "rationale": "Direct detail page navigation provides complete job descriptions vs partial search card data",
      "phase_1": "5 concurrent search pages, parse cards, extract titles + URLs",
      "phase_2": "5 concurrent detail pages, extract full descriptions, skills, company",
      "components": [
        "PlaywrightBrowser (headless=True)",
        "Two-phase scrapers (url_scraper.py, detail_scraper.py)",
        "Detail page parsers with CSS selectors",
        "Batch processing (50 jobs per batch)",
        "Two-phase automatic database storage"
      ]
    },
    "emd_compliance": {
      "url_scraper": "79 lines (async URL collection, Playwright, BeautifulSoup)",
      "detail_scraper": "80 lines (async detail scraping with LEFT JOIN query)",
      "wrapper": "11 lines (thin re-export layer)",
      "benefit": "Maximum 80 lines per file, easy maintenance, clear separation of concerns"
    },
    "selector_patterns": {
      "naukri_list": "article.jobTuple, .cust-job-tuple",
      "naukri_detail": "div.styles_JDC__dang-inner-html__h0K4t",
      "indeed_list": "div.job_seen_beacon",
      "indeed_detail": "div#jobDescriptionText"
    }
  },
  "database_patterns": {
    "normalization": {
      "input_role": "Lowercase with underscores (e.g., 'AI Engineer' -> 'ai_engineer')",
      "job_id": "MD5 hash of platform + URL (16 chars)"
    },
    "deduplication": {
      "url_level": "UNIQUE(platform, url) in job_urls table",
      "detail_level": "Query unscraped: LEFT JOIN where jobs.job_id IS NULL"
    },
    "performance": {
      "indexes": ["platform_role on job_urls", "url on both tables", "platform on jobs"],
      "foreign_key": "jobs.job_id references job_urls.job_id"
    }
  },
  "technical_stack": {
    "browser_automation": "Playwright (async, headless)",
    "html_parsing": "BeautifulSoup4",
    "database": "SQLite with two-table schema",
    "models": "Pydantic v2 with validation",
    "skill_extraction": "Regex-based from full descriptions",
    "concurrency": "asyncio with batch processing"
  },
  "mcp_integration": {
    "filesystem": "Read/write memory bank schemas and code files",
    "context7": "Validate database patterns and Pydantic models",
    "memory": "Store two-table optimization patterns",
    "time": "Timestamp all operations",
    "git": "Version control checkpoints",
    "math": "Compute schema compliance scores",
    "sequential_thinking": "Plan multi-step refactoring"
  }
}
